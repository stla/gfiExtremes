---
title: "The 'gfiExtremes' package"
output: 
  rmarkdown::html_vignette:
    css: vignette.css
vignette: >
  %\VignetteIndexEntry{The 'gfiExtremes' package}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
editor_options: 
  chunk_output_type: console
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.width = 6,
  fig.height = 5
)
```

```{r setup, message=FALSE}
library(gfiExtremes)
```


## The model with a known threshold

When the threshold $\mu$ is known, it is assumed that the data are independent 
realizations of a random variable $X$ which follows a generalized Pareto 
distribution $GP(\mu,\gamma,\sigma)$ conditionally to $X \geqslant \mu$. On the 
event $X < \mu$, no distributional assumption is made.

Then the algorithm performed by the `gfigpd1` function produces some simulations
of the fiducial distributions of $\gamma$, $\sigma$ and of the 
$(100\beta\%)$-quantiles of $X$ at the requested values of $\beta$.

For example, assume that $X$ follows the $GP(\mu,\gamma,\sigma)$ distribution 
(so $X < \mu$ never happens). 

```{r gfigpd1}
set.seed(666L)
X <- rgpareto(200L, mu = 10, gamma = 0.3, sigma = 2)
gf1 <- gfigpd1(X, beta = c(0.99, 0.995, 0.999), threshold = 10, iter = 10000L)
```

The output of `gfigpd1` is a R object ready for analysis with the 'coda' 
package. In particular, it has a `summary` method.

```{r summary_gfigpd1}
summary(gf1)
# compare with the true quantiles:
qgpareto(c(0.99, 0.995, 0.999), mu = 10, gamma = 0.3, sigma = 2)
```

Every parameter is very well estimated by the median of its fiducial 
distribution.


## The model with an unknown threshold

